---
layout: post
title:  "k-level"
date:   2022-9-25 00:00:00 +0800
categories: alg
---

[K-set](https://en.wikipedia.org/wiki/K-set_(geometry))

## duality between point and line

二维平面上有一条直线$y=ax-b$和一个点$(c,d)$，现在我想描述一下点和直线之间的相对位置；
点如果在直线上面，说明$x=c$的时候直线取得的$y$小于$d$,也就是说$d>ac-b$，这里也可以将
$c,d$看成系数，$a,b$当成带入的坐标，表示的意思变成$(a,b)$这个点位于直线$y=cx-d$的上面

## upper envelope of linear functions

现在二维平面上有很多条直线，我想找到最上面的边缘线(upper envelope)

![fig1]({{url}}/assets/image/k-level/fig1.svg)

假设在横坐标为$x'$处直线$y=ax-b$位于 upper envelope 上，这个点$(x',y')$位于所有其他直线上方，
那么根据对偶，这些直线对偶对应的点也都位于点$(x',y')$对应的直线的上方，而实际上这条直线就是凸包的下边缘，
因为它一定过某个直线对偶对应的点。

## k-level

k-level 是推广的upper envelope，找的是最上面的k条直线(实际上定义是下方正好有k条直线的那个边缘线)，
也就是需要找到正好上方有k-1条直线的那个边缘线。这个边缘线上的点上方应该有恰好k-1条直线，
下方有n-k条直线。类似upper envelope 的处理，研究和直线互为对偶的点。要找的是一个类似凸包下边缘的东西
上的点，这些点对应的直线就是能够出现在k-level 边缘线上的那些直线。

下面是
[1999 Timothy M. Chan](https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.44.9042&rep=rep1&type=pdf)
中的算法

首先容易的方法是枚举所有直线的交点$O(n^2)$，然后对这些交点分出的所有区间计算最大的k个直线（应该是$O(n^3)$，
$n^2$个区间，每个区间用median of medians线性时间找到top k）

[1999 Timothy M. Chan](https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.44.9042&rep=rep1&type=pdf)
的思路是从左到右扫描x轴，维护两个优先队列，一个维护在当前的x rank小于k的直线是哪些，一个维护大于等于k的是哪些。如果把
横轴x看成时间，优先队列在维护一些会在一维直线上做匀速运动的点，这种东西叫做
[kinetic data structure](https://en.wikipedia.org/wiki/Kinetic_data_structure)，实现方法先不讨论

有了这种数据结构之后就可以按照这样的步骤维护 k-level:
![fig2]({{url}}/assets/image/k-level/fig2.jpg)

## detail

